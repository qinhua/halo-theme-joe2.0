(()=>{var n={initEffect:function(){$(".joe_loading").remove(),$(".joe_journals__list").removeClass("hidden"),ThemeConfig.enable_journal_effect&&new WOW({boxClass:"wow",animateClass:ThemeConfig.journal_list_effect_class||"fadeIn",offset:0,mobile:!0,live:!0}).init()},formatTime:function(){$(".joe_journal-posttime").each(function(){var e=$(this);e.html(Utils.timeAgo(e.text()))})},initLike:function(){var e;ThemeConfig.enable_like_journal&&(e=$(".joe_journal__item")).length&&e.each(function(e,n){var o=$(this),a=o.attr("data-cid"),i=+(o.attr("data-clikes")||0),l=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=l.includes(a),c=o.find(".journal-like"),s=o.find(".journal-unlike"),u=o.find(".journal-likes-num");r?(c.hide(),s.show()):(c.show(),s.hide()),u.html(i),c.on("click",function(e){e.stopPropagation();l=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=l.includes(a),Utils.request({url:"/api/content/journals/"+a+"/likes",method:"POST",data:{type:r?"disagree":"agree"}}).then(function(e){var n=i,o=(r?(n--,o=l.findIndex(function(e){return e===a}),l.splice(o,1),c.show(),s.hide()):(n++,l.push(a),c.hide(),s.show()),encryption("agree-journal")),t=encryption(JSON.stringify(l));localStorage.setItem(o,t),u.html(n)}).catch(function(e){})})})},initComment:function(){!ThemeConfig.enable_clean_mode&&ThemeConfig.enable_comment_journal&&$(".journal_comment_expander,.journal-comment").on("click",function(e){e.stopPropagation();var e=$(this).parents(".footer-wrap"),n=e.find("halo-comment")[0]._wrapper.$refs.inner;e.hasClass("open")||n.loadComments(),e.toggleClass("open"),e.find(".journal_comment_expander_txt").html((e.hasClass("open")?"收起":"查看")+"评论")})},initExpander:function(){$(".journal_content_expander i").on("click",function(e){e.stopPropagation(),$(this).parents(".joe_journal_body").toggleClass("open")})},foldBlock:function(){$(".joe_journal_body .content-wrp").each(function(){var e=$(this);e[0].getBoundingClientRect().height>=ThemeConfig.journal_block_height&&e.siblings(".journal_content_expander").show()})}},o=["foldBlock"];document.addEventListener("DOMContentLoaded",function(){Object.keys(n).forEach(function(e){return!o.includes(e)&&n[e]()})}),window.addEventListener("load",function(){n.foldBlock()})})();