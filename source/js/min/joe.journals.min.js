!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var o=n();for(var t in o)("object"==typeof exports?exports:e)[t]=o[t]}}(self,(function(){return n={initEffect:function(){$(".joe_loading").remove(),$(".joe_journals__list").removeClass("hidden"),ThemeConfig.enable_journal_effect&&new WOW({boxClass:"wow",animateClass:ThemeConfig.journal_list_effect_class||"fadeIn",offset:0,mobile:!0,live:!0}).init()},formatTime:function(){$(".joe_journal-posttime").each((function(){var e=$(this);e.html(Utils.timeAgo(e.text().replace(/-/g,"/")))}))},initLike:function(){if(ThemeConfig.enable_like_journal){var e=$(".joe_journal__item");e.length&&e.each((function(e,n){var o=$(this),t=o.attr("data-cid"),a=+(o.attr("data-clikes")||0),i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[],r=o.find(".journal-like"),l=o.find(".journal-unlike"),c=o.find(".journal-likes-num");i.includes(t)?(r.hide(),l.show()):(r.show(),l.hide()),c.html(a),r.on("click",(function(e){e.stopPropagation();var n=!1;if(!n){n=!0;var o=(i=localStorage.getItem(encryption("agree-journal"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree-journal")))):[]).includes(t);$.ajax({url:"/api/content/journals/"+t+"/likes",type:"POST",dataType:"json",data:{type:o?"disagree":"agree"},success:function(e){if(200===e.status){var n=a;if(o){n--;var s=i.findIndex((function(e){return e===t}));i.splice(s,1),r.show(),l.hide()}else n++,i.push(t),r.hide(),l.show();var f=encryption("agree-journal"),u=encryption(JSON.stringify(i));localStorage.setItem(f,u),c.html(n)}},error:function(e){return n=!1,Qmsg.warning(e.responseJSON.message)},complete:function(){n=!1}})}}))}))}},initComment:function(){!ThemeConfig.enable_clean_mode&&ThemeConfig.enable_comment_journal&&$(".journal_comment_expander,.journal-comment").on("click",(function(e){e.stopPropagation();var n=$(this).parents(".footer-wrap"),o=n.find("halo-comment")[0]._wrapper.$refs.inner;n.hasClass("open")||o.loadComments(),n.toggleClass("open"),n.find(".journal_comment_expander_txt").html((n.hasClass("open")?"收起":"查看")+"评论")}))},initExpander:function(){$(".journal_content_expander i").on("click",(function(e){e.stopPropagation(),$(this).parents(".joe_journal_body").toggleClass("open")}))},foldBlock:function(){$(".joe_journal_body .content-wrp").each((function(){var e=$(this);e[0].getBoundingClientRect().height>=ThemeConfig.journal_block_height&&e.siblings(".journal_content_expander").show()}))}},e=["foldBlock"],document.addEventListener("DOMContentLoaded",(function(){Object.keys(n).forEach((function(o){return!e.includes(o)&&n[o]()}))})),window.addEventListener("load",(function(){n.foldBlock()})),{};var e,n}));