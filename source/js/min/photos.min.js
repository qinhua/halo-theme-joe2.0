(()=>{"use strict";function a(a,t){var e,o=Object.keys(a);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(a),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})),o.push.apply(o,e)),o}function g(o){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){var a,e;a=o,e=n[t=t],t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}var u={initEffect:function(t){ThemeConfig.enable_photos_effect&&new WOW({boxClass:"wow",animateClass:"grid"===t?"bounceIn":"fadeIn",offset:0,mobile:!0,live:!0}).init()},initList:function(){function a(t){new Promise(function(n,a){p=!0,r.show();var i=g(g({},o),t||{});""===i.team&&delete i.team,Utils.request({url:"/api/content/photos",method:"GET",data:i}).then(function(t){var a,e,o=t.content||[];0===o.length?0===i.page&&(c.hide(),l.removeClass("hide")):(a=o,"grid"===h?(a&&(e=a.reduce(function(t,a,e){return t.concat(['<a class="item animated wow" data-wow-diration="0.3s" data-wow-delay="0.'.concat(e,'s" href="').concat(a.url,'" data-fancybox="gallery" data-caption="').concat(a.name||"",'">\n        <img width="100%" height="100%" class="lazyloadx" src="').concat(a.thumbnail,'" alt="').concat(a.name||"",'"/>\n        <span class="team" style="background-color:').concat(Utils.getRandomColor(.2,.5),'">').concat(a.team,'</span>\n        <p class="tit">').concat(a.name,'</p>\n        <div class="info">\n          <p class="animated fadeInRightBig"><i class="joe-font joe-icon-paizhao"></i><span>').concat(a.name,"</span></p>\n          ").concat(a.location?'<p class="animated fadeInRightBig"><i class="joe-font joe-icon-dingwei"></i><span>'.concat(a.location,"</span></p>"):"",'\n          <p class="animated fadeInRightBig"><i class="joe-font joe-icon-shijian"></i>').concat(Utils.formatDate(a.takeTime),"</p>\n        </div>\n      </a>")])},[]),c.append(e.join(""))),c.justifiedGallery({rowHeight:200,maxRowHeight:!1,maxRowsCount:0,sizeRangeSuffixes:{},lastRow:"nojustify",captions:!1,waitThumbnailsLoad:!0,margins:ThemeConfig.photos_gap,extension:/\.(jpe?g|png|gif|bmp|webp)$/,cssAnimation:!1}).on("jg.complete",function(t){p=d=!1})):Masonry&&imagesLoaded&&(a&&a.forEach(function(t,a){a=$('<a class="item masonry-item animated wow" style="margin-bottom:'.concat(ThemeConfig.photos_gap||"10",'px" data-wow-diration="0.3s" data-wow-delay="0.').concat(a,'s" href="').concat(t.url,'" data-fancybox="gallery" data-caption="').concat(t.name||"",'">\n      <img width="100%" height="100%" class="lazyload" rsrc="').concat(ThemeConfig.photo_lazyload_img||ThemeConfig.LAZY_IMG,'" src="').concat(t.thumbnail,'" alt="').concat(t.name||"",'"/>\n      <span class="team" style="background-color:').concat(Utils.getRandomColor(.2,.5),'">').concat(t.team,'</span>\n      <p class="tit">').concat(t.name,'</p>\n      <div class="info">\n        <p class="animated fadeInRightBig"><i class="joe-font joe-icon-paizhao"></i><span>').concat(t.name,"</span></p>\n        ").concat(t.location?'<p class="animated fadeInRightBig"><i class="joe-font joe-icon-dingwei"></i><span>'.concat(t.location,"</span></p>"):"",'\n        <p class="animated fadeInRightBig"><i class="joe-font joe-icon-shijian"></i>').concat(Utils.formatDate(t.takeTime),"</p>\n      </div>\n    </a>"));c.append(a),s&&s.append(a).masonry("appended",a)}),c.imagesLoaded(function(){(s=c.masonry({itemSelector:".masonry-item",columnWidth:ThemeConfig.photos_gap,gutter:ThemeConfig.photos_gap,horizontalOrder:!0,percentPosition:!0,initLayout:!0,fitWidth:!0,resize:!0,transitionDuration:"0.2s"})).masonry("on","layoutComplete",function(){console.log("waterfall layout is complete"),p=d=!1})})),d&&u.initEffect(h),l.addClass("hide"),c.show(),t.isLast?m=!0:l.addClass("hide")),r.hide(),c.show(),f=0<i.page?f.concat(o):o,n(o)}).catch(function(t){r.hide(),l.removeClass("hide"),p=!1,a(t)})})}function e(t){c.empty().hide(),p=m=!(d=!0),o.page=0,a(t)}var s,c=$(".joe_photos__gallery"),l=$(".joe_empty"),r=$(".joe_loading"),o={page:0,size:10,sort:"createTime,desc"},p=!1,d=!0,m=!1,f=[],h=ThemeConfig.photos_layout||"grid";a(),window.addEventListener("scroll",Utils.throttle(function(){$(window).scrollTop()+$(window).height()>=$(".page-photos").height()&&(p||m||(o.page++,a({team:$(".joe_photos__filter li.active").attr("data-filter"),size:10})))})),r.on("click",function(t){t.stopPropagation(),$(this).attr("loading")||(o.page++,a({team:$(".joe_photos__filter li.active").attr("data-filter")}))}),$(".joe_photos__filter li").on("click",function(t){t.stopPropagation();t=$(this);t.hasClass("active")||(t.addClass("active").siblings("li").removeClass("active"),e({team:t.attr("data-filter")}))}),$(".joe_photos__layout-switch i").on("click",function(t){t.stopPropagation();t=$(this);t.hasClass("active")||(h=t.attr("data-type"),t.addClass("active").siblings("i").removeClass("active"),s=null,c.attr({class:"",style:""}).attr("class","joe_photos__gallery "+h),e({team:$(".joe_photos__filter li.active").attr("data-filter")}))})}};document.addEventListener("DOMContentLoaded",function(){u.initList()})})();